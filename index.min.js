import t from"axios";async function r(r,e){const i={url:r,status:!0,errorMsg:"",iconUrl:"",title:"",description:""};if(!r)return i;try{const{origin:n,protocol:c}=new URL(r),s=(await t.get(n,{...e})).data;i.iconUrl=function(t,r,e){e=e.replace(":","");const i=/href="(.*?)"/i,n=t.match(/<link(.|\s)*?href="(.*?)"/gi);if(Array.isArray(n))for(const t of n)if(t.includes('rel="icon"')||t.includes("rel=icon")||t.includes("rel='icon'")||t.includes('rel="shortcut icon"')||t.includes("rel='shortcut icon'")||t.includes("rel='icon shortcut'")||t.includes('rel="icon shortcut"')||t.includes('rel="apple-touch-icon-precomposed"')||t.includes("rel='apple-touch-icon-precomposed'")||t.includes('rel="apple-touch-icon"')||t.includes("rel='apple-touch-icon'")){const n=t.match(i);if(n&&n[1]){let t=n[1];if(t.startsWith("data:image"))return t;if(t.startsWith("://"))return e+t;if(t.startsWith("//"))return e+":"+t;if(t.includes("://"))return t;if(t.startsWith("/"))return r+t;if(!t.startsWith("/"))return r+"/"+t;break}}return""}(s,n,c).trim(),i.title=function(t){const r=t.match(/<title>([^<]*)?<\/title>/i);let e="";return r&&r[1]&&(e=r[1]),e}(s).trim(),i.description=function(t){let r="";const e=/<meta(.|\s)*?\/?>/gi,i=/content="(.*?)"/i;let n;try{n=t.match(e)}catch(t){console.log("getDescriptionï¼š",t.message)}if(Array.isArray(n))for(const t of n)if(t.includes('name="description"')||t.includes("name=description")||t.includes("name='description'")){const e=t.match(i);if(e&&e[1]){r=e[1];break}}return r}(s).trim()}catch(t){i.errorMsg=t.message,i.status=!1}return i}export{r as default};
